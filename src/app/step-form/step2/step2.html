<div class="container-fluid px-0">
  <!-- Título y progreso -->
  <div class="header-title">Registro</div>
  <div class="progress-bar-bg">
    <div class="progress-bar-fill"
         [style.width.%]="(currentStep/maxSteps)*100">
    </div>
  </div>
  <p class="progress-step">Paso {{ currentStep }} de {{ maxSteps }}</p>

  <div class="main-container mt-4">
    <div class="section-header">SELECCIÓN DE PERFIL</div>
    <div class="divider"></div>

    <div class="section-content">
      <!-- FORM -->
      <form [formGroup]="form" (ngSubmit)="agregarPerfil()">
        <div class="form-inline mb-0">
          <label for="perfilInput" class="form-label">*Perfil:</label>

          <!-- input con datalist -->
          <input id="perfilInput"
                 type="text"
                 formControlName="perfil"
                 list="listaPerfiles"
                 class="form-control"
                 placeholder="Ej: 3101 SUPERVISOR IPH" />

          <datalist id="listaPerfiles">
            @for (perfil of perfilesFiltrados; track $index) {
              <option [value]="`${perfil.CLAVE} - ${perfil.FUNCION}`"></option>
            }
          </datalist>

          <button type="button"
                  class="btn btn-agregar"
                  (click)="agregarPerfil()">
            Agregar
          </button>
        </div>
      </form>

      <!-- LISTA -->
      <div class="perfil-list mt-3">
        @for (perfil of perfilesAgregados; track $index) {
          <div class="perfil-item">
            <span class="perfil-id">{{ perfil.CLAVE }}</span>
            <span class="perfil-remove"
                  (click)="eliminarPerfil($index)">
              <i class="fas fa-times"></i>
            </span>
            <span class="perfil-desc">{{ perfil.FUNCION }}</span>
          </div>
        }
        @empty {
          <div class="text-muted">No hay perfiles agregados.</div>
        }
      </div>
    </div>

    <div class="divider mt-4"></div>

    <!-- Botones de pie -->
    <div class="footer-actions">
      <button class="btn btn-regresar" (click)="prev.emit()">Regresar</button>
      <button class="btn btn-siguiente" (click)="next.emit()">Siguiente</button>
    </div>
  </div>
</div>
