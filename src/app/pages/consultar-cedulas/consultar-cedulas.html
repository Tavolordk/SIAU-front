<!-- Header reutilizable a 100% -->
<app-header-siau [title]="'Sistema Integral de Administración de Usuarios'" [userName]="usuarioNombre"
  [userRole]="usuarioRol" [logoSrc]="'assets/images/SSPC.png'" [bgSrc]="'assets/images/encabezado.png'" [height]="110">
</app-header-siau>

<!-- Página full width -->
<div class="page-shell container-fluid px-0">
  <h1 class="main-title">Consultar Cédulas</h1>
  <button class="new-request-btn" type="button">Nueva solicitud</button>
  <!-- Botón flotante de menú -->
  <button class="sidebar-btn" type="button" (click)="onToggleSidebar()">
    <fa-icon [icon]="icBars"></fa-icon>
  </button>
  <!-- Filtros -->
  <div class="filter-card shadow-sm">
    <div class="d-flex flex-wrap align-items-center mb-2 gap-2">

      <!-- Información Personal -->
      <div class="filter-dropdown" [class.open]="open==='personal'">
        <button class="btn btn-light dropdown-toggle w-100 text-start" type="button"
          (click)="toggleDropdown('personal', $event)">
          Información Personal
          <fa-icon [icon]="icons.chevronDown" class="float-end"></fa-icon>
        </button>

        <div class="dropdown-menu" *ngIf="open==='personal'" (click)="$event.stopPropagation()">
          <div class="row g-2">
            <div class="col-6">
              <label>Usuario</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>Nombre (s)</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>Primer Apellido</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>Segundo Apellido</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>CURP</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>RFC</label>
              <input type="text" class="form-control" />
            </div>
          </div>
        </div>
      </div>

      <!-- Información de Solicitud -->
      <div class="filter-dropdown" [class.open]="open==='solicitud'">
        <button class="btn btn-light dropdown-toggle w-100 text-start" type="button"
          (click)="toggleDropdown('solicitud', $event)">
          Información de Solicitud
          <fa-icon [icon]="icons.chevronDown" class="float-end"></fa-icon>
        </button>

        <div class="dropdown-menu" *ngIf="open==='solicitud'" (click)="$event.stopPropagation()">
          <div class="row g-2">
            <div class="col-6">
              <label>Fecha Desde:</label>
              <input type="date" class="form-control" />
            </div>
            <div class="col-6">
              <label>Hasta:</label>
              <input type="date" class="form-control" />
            </div>
            <div class="col-6">
              <label>Folio</label>
              <input type="text" class="form-control" />
            </div>
            <div class="col-6">
              <label>Tipo de Solicitud</label>
              <select class="form-select">
                <option>Seleccionar...</option>
                <option>Nueva Cuenta</option>
                <option>Modificación de Perfil / Adscripción</option>
                <option>Reactivación de Cuenta</option>
                <option>Ampliación de Perfiles</option>
              </select>
            </div>
            <div class="col-6">
              <label>Estatus</label>
              <select class="form-select">
                <option>Seleccionar...</option>
                <option>Recibida</option>
                <option>Guardada</option>
                <option>Validada</option>
                <option>Aprobada</option>
                <option>Cancelada</option>
                <option>Rechazada</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Información Institucional/Estatal -->
      <div class="filter-dropdown" [class.open]="open==='institucional'">
        <button class="btn btn-light dropdown-toggle w-100 text-start" type="button"
          (click)="toggleDropdown('institucional', $event)">
          Información Institucional/Estatal
          <fa-icon [icon]="icons.chevronDown" class="float-end"></fa-icon>
        </button>

        <div class="dropdown-menu" *ngIf="open==='institucional'" (click)="$event.stopPropagation()">
          <div class="row g-2">
            <div class="col-6">
              <label>Tipo de Institución</label>
              <select class="form-select">
                <option>Municipal</option>
                <option>Estatal</option>
                <option>Federal</option>
              </select>
            </div>
            <div class="col-6">
              <label>Entidad</label>
              <select class="form-select">
                <option>Coahuila de Zaragoza</option>
                <option>Michoacán de Ocampo</option>
                <option>Tamaulipas</option>
                <option>Estado de México</option>
                <option>Guerrero</option>
                <option>Oaxaca</option>
              </select>
            </div>
            <div class="col-6">
              <label>Municipio</label>
              <select class="form-select">
                <option>San Juan de Sabinas</option>
                <option>Bejucal de Ocampo</option>
                <option>Atlamajalcingo del Río</option>
                <option>Yaxcabá</option>
              </select>
            </div>
            <div class="col-6">
              <label>Institución</label>
              <select class="form-select">
                <option>Secretaría de Gobierno</option>
                <option>SSPC</option>
                <option>FGR</option>
                <option>CNI</option>
              </select>
            </div>
            <div class="col-6">
              <label>Dependencia</label>
              <select class="form-select">
                <option>Seleccionar...</option>
                <option>División Científica</option>
                <option>Guardia Nacional</option>
              </select>
            </div>
            <div class="col-6">
              <label>Corporación</label>
              <select class="form-select">
                <option>Seleccionar...</option>
                <option>CSEN</option>
                <option>Policía Estatal</option>
                <option>Policía Municipal</option>
              </select>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="d-flex flex-wrap align-items-center mb-2 gap-2">
      <span class="filter-info">Fecha: 2025-03-01 / 2025-03-15 <i class="far fa-calendar-alt"></i></span>
      <span class="filter-info">Entidad: Chiapas <i class="fas fa-map-marker-alt"></i></span>
      <span class="filter-info">Tipo de Solicitud: Nueva Cuenta <i class="fas fa-file-alt"></i></span>
    </div>

    <div class="d-flex flex-wrap align-items-center mb-2 gap-2">
      <button class="filter-btn" type="button" (click)="onBuscar()">Buscar</button>
      <button class="filter-btn-secondary" type="button" (click)="onLimpiar()">Limpiar</button>
    </div>
  </div>

  <!-- Tabla -->
  <div class="table-card shadow-sm mt-4">
    <div class="table-scroll">
      <table class="table custom-table mb-0">
        <thead>
          <tr>
            <th style="width:32px;"></th>
            <th>Folio</th>
            <th>Fecha</th>
            <th>Nombre(s)</th>
            <th>Primer Apellido</th>
            <th>Segundo Apellido</th>
            <th>Usuario</th>
            <th>Tipo de Solicitud</th>
            <th>Tipo de Institución</th>
            <th>Entidad, Municipio</th>
            <th>Institución, Dependencia, Corporación</th>
            <th>Información relacionada en RNPSP</th>
            <th>Información relacionada en SAU</th>
            <th>Resultado integral ECCC</th>
            <th>Estatus</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of pageRows; trackBy: trackByFolio">
            <td><input type="checkbox" class="table-checkbox"></td>
            <td>{{ row.folio }}</td>
            <td>{{ row.fecha }}</td>
            <td>{{ row.nombres }}</td>
            <td>{{ row.primerApellido }}</td>
            <td>{{ row.segundoApellido }}</td>
            <td>{{ row.usuario }}</td>
            <td>{{ row.tipoSolicitud }}</td>
            <td>{{ row.tipoInstitucion }}</td>
            <td>{{ row.entidadMunicipio }}</td>
            <td>{{ row.instDepCorp }}</td>
            <td>{{ row.rnpsp }}</td>
            <td>{{ row.sau }}</td>
            <td>{{ row.resultadoEccc }}</td>
            <td>
              <span class="status-badge" [ngClass]="row.estatusClase">{{ row.estatusTexto }}</span>
            </td>
            <td class="action-icons">
              <button class="icon-btn" type="button" (click)="onComment(row)">
                <fa-icon [icon]="icons.comment"></fa-icon>
              </button>
              <button class="icon-btn" type="button" (click)="onDocs(row)">
                <fa-icon [icon]="icons.file"></fa-icon>
              </button>
              <button class="icon-btn" type="button" (click)="onView(row)">
                <fa-icon [icon]="icons.eye"></fa-icon>
              </button>
            </td>
          </tr>
        </tbody>

      </table>
    </div>

    <div class="table-footer">
      <button class="approve-btn" type="button" (click)="onAprobar()">Aprobar</button>
      <app-pagination [items]="rows" [pageSize]="10" [hideOnSinglePage]="false" (pageItemsChange)="pageRows = $event">
      </app-pagination>
    </div>
  </div>
</div>